// 最新2講座: A=プレゼンテーションスキル向上研修 (2025-08-30), B=Excelデータ分析実践講座 (2025-08-21)
// 取得した topK=50 件ずつのサーベイデータから統計を算出

const courseMeta = {
	A: { id: '140795a7-5de3-4fd5-ad84-c72ccc844b42', name: 'プレゼンテーションスキル向上研修', conductedAt: '2025-08-30T22:54:57Z' },
	B: { id: '73bf5ddd-f2d2-49ef-bbdd-b09501be50d8', name: 'Excelデータ分析実践講座', conductedAt: '2025-08-21T08:47:45Z' },
};

// 必要フィールドのみに圧縮（コメント等は分析で利用）
const courseA = [
{"s":4,"d":3,"imp":"自主学習用の追加演習パックをダウンロード提供してほしい。","satC":"議論を活性化する問いかけが効果的でした。 期待値を上回る部分と下回る部分が混在したが総合的には満足です。","difC":"ちょうど良い難易度で退屈せず挫折もせず進められました。"},
{"s":1,"d":1,"imp":"ショートクイズ形式でインタラクティブ性を上げてほしい。 資料に索引があると助かる。後から特定の概念を引きたい場面があります。","satC":"満足できなかったです。紹介された手法が既に社内で利用済みでした。","difC":"応用シナリオがなく発展の方向性が見えませんでした。"},
{"s":4,"d":1,"imp":"成果測定指標(KPI)例をもう少し体系化してほしい。","satC":"軽微な資料の誤字が散見された点のみ惜しいです。","difC":"入門レベルで止まっており学習意欲を刺激しにくかったです。 もっと発展的な内容が欲しいと強く感じました。"},
{"s":5,"d":4,"imp":"社内事例を持ち寄るワークショップ形式の回を別途開催してほしい。","satC":"学習ゴールの再掲が適切なタイミングで挿入され集中力を維持できました。 前提知識の差異を吸収する導入パートが丁寧で全員が足並み揃いました。","difC":"計算量より概念比較の比重が高く思考整理の訓練になりました。 考えながら進められ理解定着に有効な負荷レベルでした。"},
{"s":2,"d":5,"imp":"ベストプラクティスとアンチパターンを対比で整理してほしい。 ライブコーディング/ライブデモの時間を設けて実践感を高めてほしい。","satC":"現場課題との接続が弱く導入価値を示す説明が不足していました。","difC":"演習が複合思考を要求し適切な負荷を超えて少しオーバーに感じました。 高度で復習が必要だが挑戦的で成長実感がありました。"},
{"s":5,"d":3,"imp":"関連する上級編も受講したい。中級→上級への学習パスを提示してほしいです。","satC":"実務にすぐ活かせる素晴らしい講座でした。補助資料も充実しており復習が容易です。","difC":"理論と実践が交互に現れ集中維持に寄与していました。 一般的な前提知識を持つ受講者なら問題無い平衡レベルです。"},
{"s":3,"d":3,"imp":"社内事例を持ち寄るワークショップ形式の回を別途開催してほしい。","satC":"後半の集中度が下がる構成だったので再活性化の仕掛けが欲しいです。","difC":"適切なバランスでした。基礎→応用の橋渡しが滑らかです。"},
{"s":4,"d":5,"imp":"ベストプラクティスとアンチパターンを対比で整理してほしい。","satC":"参加者同士の視点共有が整理され価値がありました。","difC":"高度で復習が必要だが挑戦的で成長実感がありました。"},
{"s":4,"d":5,"imp":"社内導入テンプレートを配布してほしい。 自主学習用の追加演習パックをダウンロード提供してほしい。","satC":"概ね満足です。細部でもう一歩踏み込んだ考察があれば満点でした。 得られるアウトプットが明確で学習意図を維持しやすかったです。","difC":"制約条件が頻繁に変動するシナリオで思考の柔軟性を試されました。"},
{"s":5,"d":5,"imp":"","satC":"課題へのフィードバックが粒度高く改善ポイントが即把握できました。 総合的に投資対効果が極めて高い講座だと評価しています。","difC":"知識統合を前提とした複線的な課題設計で集中力を強く要しました。 制約条件が頻繁に変動するシナリオで思考の柔軟性を試されました。"},
{"s":4,"d":5,"imp":"質疑応答の時間をもう少し長くしてほしい。口頭で深掘れる余地が残りました。","satC":"参加者同士の視点共有が整理され価値がありました。 ガイドライン化のヒントが多く次アクションを描きやすかったです。","difC":"複数解が成立する問題設定がメタ認知を促進し負荷は高いが有益でした。"},
{"s":4,"d":3,"imp":"質疑応答の時間をもう少し長くしてほしい。口頭で深掘れる余地が残りました。 追加の参考図書リストを提供してほしい。段階別推薦があると助かります。","satC":"社内共有しやすい要約フォーマットが提供されると最高です。 質疑応答で多様な観点の質問が拾われ理解が深まりました。","difC":"理論と実践が交互に現れ集中維持に寄与していました。 段階的に複雑性が増すが急激な跳ね上がりは無く安心して進めました。"},
{"s":4,"d":4,"imp":"ロールプレイの録画振り返り機能があると改善が加速しそうです。","satC":"演習の難度が一部バラついていた印象ですが概ね有益でした。","difC":"初見語彙が適度に散りばめられており学習刺激になりました。"},
{"s":3,"d":4,"imp":"社内事例を持ち寄るワークショップ形式の回を別途開催してほしい。","satC":"演習フィードバックが定型で個別指摘が少なかったです。 可もなく不可もなく。中級者向けの発展編があれば参加したいです。","difC":"同時並行で評価軸を意識する必要があり集中が要求されました。 やや難しかったですが段階的説明で何とか追従できました。"},
{"s":2,"d":4,"imp":"確認テストを追加し理解度セルフチェックを可能にしてほしい。","satC":"セクション間のストーリー遷移が唐突で認知負荷が高まりました。","difC":"計算量より概念比較の比重が高く思考整理の訓練になりました。 考えながら進められ理解定着に有効な負荷レベルでした。"},
{"s":3,"d":5,"imp":"","satC":"アンケート結果を踏まえ次回改善されれば再受講も検討します。","difC":"難易度が高く歯応えがあり深い理解には追加復習が必須だと感じました。 制約条件が頻繁に変動するシナリオで思考の柔軟性を試されました。"},
{"s":3,"d":3,"imp":"","satC":"普通です。基礎復習には十分ですが新しい気づきは限定的でした。","difC":"集中していれば問題なく理解できるが事前知識ゼロだと厳しい可能性があります。"},
{"s":5,"d":3,"imp":"配布スライドに補足脚注を追加して発展資料の参照元を知りたいです。","satC":"現場シナリオを段階的に分解する進め方が実務思考に直結して良かったです。 期待以上の内容でした。直後の業務改善ミーティングで早速活用できました。","difC":"要点を押さえつつ過剰に難化させない設計が好印象でした。"},
{"s":4,"d":1,"imp":"ロールプレイの録画振り返り機能があると改善が加速しそうです。","satC":"演習の難度が一部バラついていた印象ですが概ね有益でした。 期待値を上回る部分と下回る部分が混在したが総合的には満足です。","difC":"難度指標が公開されていれば受講判断を変えたかもしれません。"},
{"s":5,"d":4,"imp":"匿名質問ボックスを常設してほしい。 確認テストを追加し理解度セルフチェックを可能にしてほしい。","satC":"期待以上の内容でした。直後の業務改善ミーティングで早速活用できました。 参加者間の相互フィードバック設計が学びの多層化に寄与していました。","difC":"初見語彙が適度に散りばめられており学習刺激になりました。 やや難しかったですが段階的説明で何とか追従できました。"},
{"s":5,"d":4,"imp":"終了後のアンケート集計レポートを共有してほしい。","satC":"課題へのフィードバックが粒度高く改善ポイントが即把握できました。","difC":"集中していれば問題なく理解できるが事前知識ゼロだと厳しい可能性があります。"},
{"s":4,"d":2,"imp":"匿名質問ボックスを常設してほしい。","satC":"役立つポイントが多かったです。事前課題との連動性も高く準備がしやすかった。","difC":"段階ジャンプが少なく緊張感がやや不足しました。 想定より平易で学習投資対効果が低く感じました。"},
{"s":4,"d":4,"imp":"匿名質問ボックスを常設してほしい。","satC":"実例が現場に近く納得感が高かったです。復習ガイドがあればさらに良い。","difC":"やや難しかったですが段階的説明で何とか追従できました。"},
{"s":4,"d":3,"imp":"","satC":"演習の難度が一部バラついていた印象ですが概ね有益でした。","difC":"要点を押さえつつ過剰に難化させない設計が好印象でした。 一般的な前提知識を持つ受講者なら問題無い平衡レベルです。 適切なバランスでした。基礎→応用の橋渡しが滑らかです。"},
{"s":5,"d":5,"imp":"成功事例だけでなく失敗事例の分析も増やしてほしい。","satC":"総合的に投資対効果が極めて高い講座だと評価しています。","difC":"高度で復習が必要だが挑戦的で成長実感がありました。 演習が複合思考を要求し適切な負荷を超えて少しオーバーに感じました。"},
{"s":5,"d":4,"imp":"関連する上級編も受講したい。中級→上級への学習パスを提示してほしいです。","satC":"前提知識の差異を吸収する導入パートが丁寧で全員が足並み揃いました。","difC":"同時並行で評価軸を意識する必要があり集中が要求されました。"},
{"s":1,"d":5,"imp":"受講前診断テストでレベル別カリキュラム選択ができると良い。","satC":"改善が必要と感じました。議論が脱線し時間管理が不十分でした。","difC":"制約条件が頻繁に変動するシナリオで思考の柔軟性を試されました。 演習が複合思考を要求し適切な負荷を超えて少しオーバーに感じました。"},
{"s":4,"d":1,"imp":"課題提出に対する個別フィードバックの粒度を上げてほしい。","satC":"休憩タイミングが適切で集中力を維持できました。 参加者同士の視点共有が整理され価値がありました。","difC":"もっと発展的な内容が欲しいと強く感じました。 非常に易しかったです。もう少し深度を追加してほしいです。"},
{"s":5,"d":1,"imp":"AI ツール活用の具体例をもう少し追加してほしい。","satC":"チャットでの質問にも即応してもらえストレスなく学べました。 現場シナリオを段階的に分解する進め方が実務思考に直結して良かったです。","difC":"応用シナリオがなく発展の方向性が見えませんでした。"},
{"s":1,"d":3,"imp":"追加の参考図書リストを提供してほしい。段階別推薦があると助かります。","satC":"期待値調整がされておらずミスマッチが大きかったです。","difC":"難所の直前にミニ演習があり理解導線が丁寧でした。"},
{"s":2,"d":3,"imp":"質疑応答の時間をもう少し長くしてほしい。口頭で深掘れる余地が残りました。 課題提出に対する個別フィードバックの粒度を上げてほしい。","satC":"セクション間のストーリー遷移が唐突で認知負荷が高まりました。","difC":"確認質問タイミングが挿入され自己点検が容易でした。"},
{"s":4,"d":2,"imp":"追加の参考図書リストを提供してほしい。段階別推薦があると助かります。","satC":"具体数値例がもっとあると再現性評価がしやすいと感じました。","difC":"想定より平易で学習投資対効果が低く感じました。 計算や推論の複雑性が限定的で負荷調整余地があります。"},
{"s":4,"d":2,"imp":"演習問題をもっと増やしてほしい。特に応用ケースの追加を希望します。","satC":"期待値を上回る部分と下回る部分が混在したが総合的には満足です。","difC":"復習なしで理解できたため追加チャレンジ課題が欲しくなりました。"},
{"s":4,"d":3,"imp":"追加の参考図書リストを提供してほしい。段階別推薦があると助かります。","satC":"役立つポイントが多かったです。事前課題との連動性も高く準備がしやすかった。","difC":"一般的な前提知識を持つ受講者なら問題無い平衡レベルです。"},
{"s":4,"d":4,"imp":"","satC":"軽微な資料の誤字が散見された点のみ惜しいです。","difC":"段階的に複雑性が増すが急激な跳ね上がりは無く安心して進めました。 ちょうど良い難易度で退屈せず挫折もせず進められました。 要点を押さえつつ過剰に難化させない設計が好印象でした。"},
{"s":4,"d":5,"imp":"匿名質問ボックスを常設してほしい。","satC":"軽微な資料の誤字が散見された点のみ惜しいです。","difC":"抽象フレームと計量的評価の同時適用が高度で習熟が必要です。 知識統合を前提とした複線的な課題設計で集中力を強く要しました。"},
{"s":2,"d":5,"imp":"質疑応答の時間をもう少し長くしてほしい。口頭で深掘れる余地が残りました。","satC":"演習後の講評が浅く改善策の示唆が乏しかったです。","difC":"複数解が成立する問題設定がメタ認知を促進し負荷は高いが有益でした。 難易度が高く歯応えがあり深い理解には追加復習が必須だと感じました。 高速で前提が更新され把握に遅れが生じると巻き返しが困難でした。"},
{"s":5,"d":4,"imp":"ベストプラクティスとアンチパターンを対比で整理してほしい。","satC":"非常に満足しています。講師の説明が具体例を交えて分かりやすかったです。 体系化されたフレームワーク説明と現場事例のバランスが完璧でした。 参加者間の相互フィードバック設計が学びの多層化に寄与していました。","difC":"同時並行で評価軸を意識する必要があり集中が要求されました。"},
{"s":3,"d":5,"imp":"","satC":"後半の集中度が下がる構成だったので再活性化の仕掛けが欲しいです。","difC":"複数解が成立する問題設定がメタ認知を促進し負荷は高いが有益でした。 高速で前提が更新され把握に遅れが生じると巻き返しが困難でした。"},
{"s":5,"d":4,"imp":"配布スライドに補足脚注を追加して発展資料の参照元を知りたいです。","satC":"段階的に難度が上がり成功体験を積みながら習得できる構造が優れていました。 体系化されたフレームワーク説明と現場事例のバランスが完璧でした。 追加参考資料のキュレーション品質が高く調査時間を大幅削減できました。","difC":"後半の事例分析パートだけ難度が上がるので導入クッションが欲しいです。 抽象→具体の切替が頻繁で少し認知負荷を感じました。"},
{"s":4,"d":3,"imp":"受講前診断テストでレベル別カリキュラム選択ができると良い。","satC":"演習時間が適切で理解度を確認しながら進められました。","difC":"ちょうど良い難易度で退屈せず挫折もせず進められました。 段階的に複雑性が増すが急激な跳ね上がりは無く安心して進めました。"},
{"s":4,"d":3,"imp":"自主学習用の追加演習パックをダウンロード提供してほしい。","satC":"演習の難度が一部バラついていた印象ですが概ね有益でした。","difC":"確認質問タイミングが挿入され自己点検が容易でした。"},
{"s":4,"d":3,"imp":"ショートクイズ形式でインタラクティブ性を上げてほしい。","satC":"軽微な資料の誤字が散見された点のみ惜しいです。","difC":"段階的に複雑性が増すが急激な跳ね上がりは無く安心して進めました。 ちょうど良い難易度で退屈せず挫折もせず進められました。 要点を押さえつつ過剰に難化させない設計が好印象でした。"},
{"s":4,"d":5,"imp":"匿名質問ボックスを常設してほしい。","satC":"軽微な資料の誤字が散見された点のみ惜しいです。","difC":"抽象フレームと計量的評価の同時適用が高度で習熟が必要です。 知識統合を前提とした複線的な課題設計で集中力を強く要しました。"},
{"s":2,"d":5,"imp":"課題提出に対する個別フィードバックの粒度を上げてほしい。","satC":"演習後の講評が浅く改善策の示唆が乏しかったです。","difC":"複数解が成立する問題設定がメタ認知を促進し負荷は高いが有益でした。 難易度が高く歯応えがあり深い理解には追加復習が必須だと感じました。 高速で前提が更新され把握に遅れが生じると巻き返しが困難でした。"},
{"s":5,"d":4,"imp":"ベストプラクティスとアンチパターンを対比で整理してほしい。","satC":"非常に満足しています。講師の説明が具体例を交えて分かりやすかったです。 総合的に投資対効果が極めて高い講座だと評価しています。 講師のファシリテーションが巧みで質問しやすい雰囲気が醸成されていました。","difC":"抽象→具体の切替が頻繁で少し認知負荷を感じました。 後半の事例分析パートだけ難度が上がるので導入クッションが欲しいです。"},
{"s":2,"d":2,"imp":"受講前診断テストでレベル別カリキュラム選択ができると良い。","satC":"現場課題との接続が弱く導入価値を示す説明が不足していました。","difC":"計算や推論の複雑性が限定的で負荷調整余地があります。 段階ジャンプが少なく緊張感がやや不足しました。"},
{"s":4,"d":2,"imp":"社内事例を持ち寄るワークショップ形式の回を別途開催してほしい。","satC":"演習の難度が一部バラついていた印象ですが概ね有益でした。","difC":"抽象化プロセスが省略されており深い洞察形成には至りませんでした。"}
];

// courseB (Excelデータ分析実践講座)
const courseB = [
{"s":4,"d":2,"imp":"ベストプラクティスとアンチパターンを対比で整理してほしい。","satC":"議論を活性化する問いかけが効果的でした。 休憩タイミングが適切で集中力を維持できました。","difC":"抽象化プロセスが省略されており深い洞察形成には至りませんでした。"},
{"s":3,"d":4,"imp":"質疑応答の時間をもう少し長くしてほしい。口頭で深掘れる余地が残りました。","satC":"概念導入が丁寧で初心者には良いが既習者には冗長に感じます。","difC":"計算量より概念比較の比重が高く思考整理の訓練になりました。"},
{"s":4,"d":3,"imp":"課題提出に対する個別フィードバックの粒度を上げてほしい。","satC":"前半の理論パートは充実していたが後半の適用例がやや少なく感じました。 応用のヒントを得られた一方資料の図解がやや小さく読みづらい箇所がありました。","difC":"ちょうど良い難易度で退屈せず挫折もせず進められました。"},
{"s":3,"d":1,"imp":"受講前診断テストでレベル別カリキュラム選択ができると良い。","satC":"演習がもう少し多様であれば満足度が上がったと思います。 内容は整理されているものの密度が薄く集中力が途切れる場面がありました。","difC":"演習が単純再現で思考負荷が低すぎました。"},
{"s":1,"d":5,"imp":"ベストプラクティスとアンチパターンを対比で整理してほしい。 資料に索引があると助かる。後から特定の概念を引きたい場面があります。","satC":"満足できなかったです。紹介された手法が既に社内で利用済みでした。 期待していた内容と異なりました。対象レベルの明確化が必要だと思います。","difC":"高速で前提が更新され把握に遅れが生じると巻き返しが困難でした。 専門用語と抽象度が高く中級以上向け。補助資料が無かったら厳しかったと思います。"},
{"s":5,"d":1,"imp":"自主学習用の追加演習パックをダウンロード提供してほしい。","satC":"総合的に投資対効果が極めて高い講座だと評価しています。 想定質問を先回りして説明してくれるため疑問が溜まりませんでした。","difC":"前提知識説明が長く本題が短かった印象です。"},
{"s":2,"d":4,"imp":"ライブコーディング/ライブデモの時間を設けて実践感を高めてほしい。","satC":"説明スピードが均一で重要度の強弱が伝わりにくかったです。","difC":"集中していれば問題なく理解できるが事前知識ゼロだと厳しい可能性があります。 同時並行で評価軸を意識する必要があり集中が要求されました。"},
{"s":5,"d":3,"imp":"配布スライドに補足脚注を追加して発展資料の参照元を知りたいです。","satC":"講師のファシリテーションが巧みで質問しやすい雰囲気が醸成されていました。","difC":"理論と実践が交互に現れ集中維持に寄与していました。 一般的な前提知識を持つ受講者なら問題無い平衡レベルです。 段階的に複雑性が増すが急激な跳ね上がりは無く安心して進めました。"},
{"s":5,"d":3,"imp":"社内導入テンプレートを配布してほしい。","satC":"演習→フィードバックの流れが洗練されていて学習定着を強く感じました。","difC":"ちょうど良い難易度で退屈せず挫折もせず進められました。 理論と実践が交互に現れ集中維持に寄与していました。"},
{"s":3,"d":2,"imp":"社内事例を持ち寄るワークショップ形式の回を別途開催してほしい。","satC":"説明スライドは整っているが口頭補足に依存する箇所がやや多い印象です。 講師の経験談をもう少し体系立てて整理してほしいです。","difC":"段階ジャンプが少なく緊張感がやや不足しました。"},
{"s":1,"d":4,"imp":"社内事例を持ち寄るワークショップ形式の回を別途開催してほしい。","satC":"論理展開が冗長で主要ポイントの輪郭が掴みにくかったです。 インタラクションが少なく講義一方向で眠気を誘いました。","difC":"計算量より概念比較の比重が高く思考整理の訓練になりました。"},
{"s":4,"d":5,"imp":"事例紹介を追加してほしい。業界別のバリエーションがあると嬉しいです。","satC":"演習の難度が一部バラついていた印象ですが概ね有益でした。","difC":"高度で復習が必要だが挑戦的で成長実感がありました。"},
{"s":5,"d":2,"imp":"実務導入後のフォローアップセッションを開催してほしい。","satC":"非常に満足しています。講師の説明が具体例を交えて分かりやすかったです。","difC":"段階ジャンプが少なく緊張感がやや不足しました。"},
{"s":4,"d":1,"imp":"AI ツール活用の具体例をもう少し追加してほしい。","satC":"具体数値例がもっとあると再現性評価がしやすいと感じました。","difC":"入門レベルで止まっており学習意欲を刺激しにくかったです。 基礎用語確認が大半で新規概念は極めて少なかったです。"},
{"s":4,"d":4,"imp":"自主学習用の追加演習パックをダウンロード提供してほしい。","satC":"演習の難度が一部バラついていた印象ですが概ね有益でした。","difC":"やや難しかったですが段階的説明で何とか追従できました。 考えながら進められ理解定着に有効な負荷レベルでした。"},
{"s":5,"d":2,"imp":"資料に索引があると助かる。後から特定の概念を引きたい場面があります。","satC":"参加者間の相互フィードバック設計が学びの多層化に寄与していました。","difC":"質問用に難度の高い追加オプション課題があると嬉しいです。 比較的易しかったです。復習なしで定着できそうです。"},
{"s":4,"d":2,"imp":"社内事例を持ち寄るワークショップ形式の回を別途開催してほしい。","satC":"実例が現場に近く納得感が高かったです。復習ガイドがあればさらに良い。","difC":"想定より平易で学習投資対効果が低く感じました。 復習なしで理解できたため追加チャレンジ課題が欲しくなりました。"},
{"s":5,"d":3,"imp":"","satC":"理論→演習→内省→共有のサイクルが明確で集中を最後まで保持できました。 余白時間の小ネタ解説も有益でコスト感覚が織り込まれていました。","difC":"難所の直前にミニ演習があり理解導線が丁寧でした。 段階的に複雑性が増すが急激な跳ね上がりは無く安心して進めました。 ちょうど良い難易度で退屈せず挫折もせず進められました。"},
{"s":4,"d":4,"imp":"実務導入後のフォローアップセッションを開催してほしい。","satC":"全体構成は整理されていましたが終盤のまとめがやや駆け足に感じました。","difC":"抽象→具体の切替が頻繁で少し認知負荷を感じました。"},
{"s":5,"d":3,"imp":"終了後のアンケート集計レポートを共有してほしい。","satC":"体系化されたフレームワーク説明と現場事例のバランスが完璧でした。","difC":"一般的な前提知識を持つ受講者なら問題無い平衡レベルです。"},
{"s":4,"d":3,"imp":"","satC":"演習のフィードバック粒度が均一で差別化指針がもう少し欲しかったです。 演習時間が適切で理解度を確認しながら進められました。","difC":"適切なバランスでした。基礎→応用の橋渡しが滑らかです。 要点を押さえつつ過剰に難化させない設計が好印象でした。 理論と実践が交互に現れ集中維持に寄与していました。"},
{"s":3,"d":3,"imp":"","satC":"質疑の掘り下げが浅く十分な理解確認に至っていない箇所がありました。","difC":"適切なバランスでした。基礎→応用の橋渡しが滑らかです。"},
{"s":3,"d":5,"imp":"","satC":"一部は既知の内容でしたが社内共有用の共通言語としては有用と感じました。","difC":"知識統合を前提とした複線的な課題設計で集中力を強く要しました。"},
{"s":5,"d":3,"imp":"ショートクイズ形式でインタラクティブ性を上げてほしい。","satC":"復習課題が程よくアウトプット設計も洗練されていて理解が定着しました。 演習→フィードバックの流れが洗練されていて学習定着を強く感じました。","difC":"段階的に複雑性が増すが急激な跳ね上がりは無く安心して進めました。"},
{"s":4,"d":5,"imp":"ライブコーディング/ライブデモの時間を設けて実践感を高めてほしい。","satC":"演習の難度が一部バラついていた印象ですが概ね有益でした。","difC":"高度で復習が必要だが挑戦的で成長実感がありました。 複数解が成立する問題設定がメタ認知を促進し負荷は高いが有益でした。"},
{"s":5,"d":1,"imp":"追加の参考図書リストを提供してほしい。段階別推薦があると助かります。 社内導入テンプレートを配布してほしい。","satC":"課題へのフィードバックが粒度高く改善ポイントが即把握できました。","difC":"応用シナリオがなく発展の方向性が見えませんでした。"},
{"s":3,"d":1,"imp":"関連する上級編も受講したい。中級→上級への学習パスを提示してほしいです。 ショートクイズ形式でインタラクティブ性を上げてほしい。","satC":"実務転用の橋渡しが弱く抽象論で止まる場面がありました。 後半の集中度が下がる構成だったので再活性化の仕掛けが欲しいです。","difC":"非常に易しかったです。もう少し深度を追加してほしいです。"},
{"s":5,"d":4,"imp":"配布スライドに補足脚注を追加して発展資料の参照元を知りたいです。","satC":"課題へのフィードバックが粒度高く改善ポイントが即把握できました。 想定質問を先回りして説明してくれるため疑問が溜まりませんでした。","difC":"同時並行で評価軸を意識する必要があり集中が要求されました。"},
{"s":2,"d":5,"imp":"動画で復習できるコンテンツが欲しい。短いチャプター分割だと更に良いです。","satC":"説明スピードが均一で重要度の強弱が伝わりにくかったです。 もう少し演習が欲しかったです。受動的な時間が長く集中が続きませんでした。","difC":"高度で復習が必要だが挑戦的で成長実感がありました。 制約条件が頻繁に変動するシナリオで思考の柔軟性を試されました。"},
{"s":4,"d":3,"imp":"ライブコーディング/ライブデモの時間を設けて実践感を高めてほしい。","satC":"前半の理論パートは充実していたが後半の適用例がやや少なく感じました。","difC":"一般的な前提知識を持つ受講者なら問題無い平衡レベルです。"},
{"s":5,"d":2,"imp":"","satC":"成果物テンプレートが現場投入可能なクオリティで即日活用しました。","difC":"想定より平易で学習投資対効果が低く感じました。 初学者向けとしては最適ですが再受講者には軽めです。"},
{"s":5,"d":3,"imp":"ロールプレイの録画振り返り機能があると改善が加速しそうです。","satC":"総合的に投資対効果が極めて高い講座だと評価しています。 双方向性が高く飽きずに最後まで集中できました。追加開催を希望します。","difC":"適切なバランスでした。基礎→応用の橋渡しが滑らかです。"},
{"s":5,"d":3,"imp":"ロールプレイの録画振り返り機能があると改善が加速しそうです。","satC":"講師の経験談が抽象→具体の橋渡しになり理解スピードが加速しました。 非常に満足しています。講師の説明が具体例を交えて分かりやすかったです。","difC":"一般的な前提知識を持つ受講者なら問題無い平衡レベルです。 難所の直前にミニ演習があり理解導線が丁寧でした。"},
{"s":2,"d":3,"imp":"","satC":"演習後の講評が浅く改善策の示唆が乏しかったです。 現場課題との接続が弱く導入価値を示す説明が不足していました。","difC":"一般的な前提知識を持つ受講者なら問題無い平衡レベルです。"},
{"s":4,"d":4,"imp":"確認テストを追加し理解度セルフチェックを可能にしてほしい。","satC":"得られるアウトプットが明確で学習意図を維持しやすかったです。 演習のフィードバック粒度が均一で差別化指針がもう少し欲しかったです。","difC":"集中していれば問題なく理解できるが事前知識ゼロだと厳しい可能性があります。 後半の事例分析パートだけ難度が上がるので導入クッションが欲しいです。"},
{"s":4,"d":1,"imp":"ベストプラクティスとアンチパターンを対比で整理してほしい。","satC":"実例が現場に近く納得感が高かったです。復習ガイドがあればさらに良い。","difC":"演習が単純再現で思考負荷が低すぎました。 基礎用語確認が大半で新規概念は極めて少なかったです。"},
{"s":3,"d":1,"imp":"資料に索引があると助かる。後から特定の概念を引きたい場面があります。","satC":"普通です。基礎復習には十分ですが新しい気づきは限定的でした。","difC":"演習が単純再現で思考負荷が低すぎました。 入門レベルで止まっており学習意欲を刺激しにくかったです。"},
{"s":1,"d":3,"imp":"成功事例だけでなく失敗事例の分析も増やしてほしい。","satC":"改善が必要と感じました。議論が脱線し時間管理が不十分でした。","difC":"要点を押さえつつ過剰に難化させない設計が好印象でした。"},
{"s":4,"d":3,"imp":"事例紹介を追加してほしい。業界別のバリエーションがあると嬉しいです。","satC":"全体構成は整理されていましたが終盤のまとめがやや駆け足に感じました。 役立つポイントが多かったです。事前課題との連動性も高く準備がしやすかった。","difC":"一般的な前提知識を持つ受講者なら問題無い平衡レベルです。"},
{"s":3,"d":3,"imp":"ショートクイズ形式でインタラクティブ性を上げてほしい。","satC":"後半の集中度が下がる構成だったので再活性化の仕掛けが欲しいです。 講師の経験談をもう少し体系立てて整理してほしいです。","difC":"確認質問タイミングが挿入され自己点検が容易でした。"},
{"s":2,"d":4,"imp":"追加の参考図書リストを提供してほしい。段階別推薦があると助かります。","satC":"もう少し演習が欲しかったです。受動的な時間が長く集中が続きませんでした。","difC":"初見語彙が適度に散りばめられており学習刺激になりました。 同時並行で評価軸を意識する必要があり集中が要求されました。"},
{"s":4,"d":4,"imp":"追加の参考図書リストを提供してほしい。段階別推薦があると助かります。","satC":"追加の深堀り資料リンクがあれば満足度はさらに上がったと思います。","difC":"後半の事例分析パートだけ難度が上がるので導入クッションが欲しいです。 やや難しかったですが段階的説明で何とか追従できました。"},
{"s":3,"d":4,"imp":"ベストプラクティスとアンチパターンを対比で整理してほしい。 追加の参考図書リストを提供してほしい。段階別推薦があると助かります。","satC":"実務転用の橋渡しが弱く抽象論で止まる場面がありました。","difC":"同時並行で評価軸を意識する必要があり集中が要求されました。"},
{"s":4,"d":1,"imp":"受講前診断テストでレベル別カリキュラム選択ができると良い。","satC":"役立つポイントが多かったです。事前課題との連動性も高く準備がしやすかった。","difC":"基礎用語確認が大半で新規概念は極めて少なかったです。 応用シナリオがなく発展の方向性が見えませんでした。 非常に易しかったです。もう少し深度を追加してほしいです。"},
{"s":4,"d":3,"imp":"ロールプレイの録画振り返り機能があると改善が加速しそうです。","satC":"質疑応答で多様な観点の質問が拾われ理解が深まりました。 休憩タイミングが適切で集中力を維持できました。","difC":"ちょうど良い難易度で退屈せず挫折もせず進められました。 確認質問タイミングが挿入され自己点検が容易でした。"},
{"s":5,"d":4,"imp":"受講前診断テストでレベル別カリキュラム選択ができると良い。","satC":"参加者間の相互フィードバック設計が学びの多層化に寄与していました。 体系化されたフレームワーク説明と現場事例のバランスが完璧でした。","difC":"やや難しかったですが段階的説明で何とか追従できました。 抽象→具体の切替が頻繁で少し認知負荷を感じました。"},
{"s":2,"d":2,"imp":"ロールプレイの録画振り返り機能があると改善が加速しそうです。","satC":"セクション間のストーリー遷移が唐突で認知負荷が高まりました。","difC":"質問用に難度の高い追加オプション課題があると嬉しいです。 復習なしで理解できたため追加チャレンジ課題が欲しくなりました。"},
{"s":3,"d":3,"imp":"","satC":"実務転用の橋渡しが弱く抽象論で止まる場面がありました。","difC":"適切なバランスでした。基礎→応用の橋渡しが滑らかです。"},
{"s":2,"d":2,"imp":"","satC":"想定より浅かったです。初学者向けを明示してほしいと感じました。","difC":"復習なしで理解できたため追加チャレンジ課題が欲しくなりました。"},
{"s":5,"d":4,"imp":"匿名質問ボックスを常設してほしい。 ベストプラクティスとアンチパターンを対比で整理してほしい。","satC":"理論→演習→内省→共有のサイクルが明確で集中を最後まで保持できました。 演習→フィードバックの流れが洗練されていて学習定着を強く感じました。","difC":"考えながら進められ理解定着に有効な負荷レベルでした。 初見語彙が適度に散りばめられており学習刺激になりました。"}
];

function stats(arr){
	const n = arr.length;
	const values = arr.slice().sort((a,b)=>a-b);
	const mean = values.reduce((a,b)=>a+b,0)/n;
	const median = n%2? values[(n-1)/2] : (values[n/2-1]+values[n/2])/2;
	const variance = values.reduce((a,b)=>a+Math.pow(b-mean,2),0)/n;
	const std = Math.sqrt(variance);
	const counts = {}; values.forEach(v=>counts[v]=(counts[v]||0)+1);
	const mode = Object.entries(counts).sort((a,b)=>b[1]-a[1])[0][0];
	return {n, mean, median, std, counts, mode: Number(mode)};
}

function pearson(xs, ys){
	const n = xs.length; if(!n) return 0;
	const mx = xs.reduce((a,b)=>a+b,0)/n; const my = ys.reduce((a,b)=>a+b,0)/n;
	let num=0, vx=0, vy=0; for(let i=0;i<n;i++){ const dx=xs[i]-mx, dy=ys[i]-my; num+=dx*dy; vx+=dx*dx; vy+=dy*dy; }
	return num/Math.sqrt(vx*vy);
}

const themeDefs = [
	{key:'匿名質問', label:'匿名質問ボックス', re:/匿名質問/},
	{key:'追加演習', label:'追加演習', re:/追加演習|演習問題をもっと|演習がもう少し|演習を.*増|演習が欲/},
	{key:'参考図書', label:'参考図書リスト', re:/参考図書|参考資料|脚注|補足脚注/},
	{key:'索引', label:'資料索引', re:/索引/},
	{key:'ワークショップ', label:'社内事例/ワークショップ', re:/社内事例|ワークショップ/},
	{key:'ベストプラクティス', label:'ベストプラクティス/アンチパターン', re:/ベストプラクティス|アンチパターン/},
	{key:'録画', label:'録画/ロールプレイ振り返り', re:/録画|ロールプレイ/},
	{key:'クイズ', label:'クイズ形式', re:/クイズ/},
	{key:'フォローアップ', label:'フォローアップ', re:/フォローアップ/},
	{key:'KPI', label:'KPI指標', re:/KPI/},
	{key:'テンプレート', label:'導入テンプレート', re:/テンプレート/},
	{key:'動画', label:'動画学習', re:/動画/},
	{key:'AI', label:'AI活用例', re:/AI\s?ツール/},
	{key:'診断', label:'事前診断/レベル分け', re:/診断テスト/},
	{key:'質問時間', label:'質疑応答時間拡張', re:/質疑応答|質問/},
];

function extractThemes(records){
	const counter = {};
	for(const r of records){ const t = r.imp||''; themeDefs.forEach(td=>{ if(td.re.test(t)) counter[td.label]=(counter[td.label]||0)+1; }); }
	return counter;
}

function analyze(courseRecords){
	const sats = courseRecords.map(r=>r.s);
	const difs = courseRecords.map(r=>r.d);
	const satStats = stats(sats);
	const difStats = stats(difs);
	const corr = pearson(sats,difs);
	const themes = extractThemes(courseRecords);
	// satisfaction banding (1-2 Low,3 Neutral,4 High,5 Very High)
	const bands = {low:0,neutral:0,high:0,veryHigh:0};
	sats.forEach(v=>{ if(v<=2) bands.low++; else if(v===3) bands.neutral++; else if(v===4) bands.high++; else bands.veryHigh++; });
	return {satStats,difStats,corr,themes,bands};
}

const analysisA = analyze(courseA);
const analysisB = analyze(courseB);

const result = { meta: courseMeta, courseA: analysisA, courseB: analysisB };

console.log('===ANALYSIS_JSON_START===' + JSON.stringify(result, null, 2) + '===ANALYSIS_JSON_END===');

